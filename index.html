<!DOCTYPE HTML>
<!--
	Striped 2.5 by HTML5 Up!
	html5up.net | @n33co
	Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
	Ported to Hexo by Adam Stokes @battlemidget
-->
<html>
  <head>
    
    <title>We are JQ</title>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />

    
        <meta name="author" content="Zx Qian and HH Jiang">
    
    
    
    <script src="/js/jquery.min.js" type="text/javascript"></script>
    <script src="/js/skel.min.js" type="text/javascript"></script>
    <script src="/js/skel-panels.min.js" type="text/javascript"></script>
    <script src="/js/init.js" type="text/javascript"></script>
    <link rel="stylesheet" href="/css/style.css" type="text/css">
    <link rel="stylesheet" href="/css/style-desktop.css" type="text/css">
    <link rel="stylesheet" href="/css/style-wide.css" type="text/css">
    <link rel="alternate" href="/atom.xml" title="We are JQ" type="application/atom+xml">
    <link rel="stylesheet" href="/js/styles/tomorrow-night.css" type="text/css">
    <script src="/js/highlight.pack.js" type="text/javascript"></script>
    <script>
        hljs.initHighlightingOnLoad();
    </script>

    

  </head>


<body class="left-sidebar">
  <!-- Wrapper -->
  <div id="wrapper">
    <!-- Content -->
    <div id="content">
      <div id="content-inner">
	
  
    <!-- Post -->
<article id="post-nodejs" class="box post post-excerpt">
  <header>
    
  
    <h2><a href="/2015/07/15/nodejs/">为什么nodejs支持高并发、非阻塞</a></h2>
  


  </header>
  <div class="info">
    <span class="date"><span class="month">Jul</span> <span class="day">15</span><span class="year">, 2015</span></span>
    <!--<ul class="stats">-->
      <!--
  <div class="addthis addthis_toolbox addthis_default_style">
    <a class="addthis_counter addthis_pill_style"></a>
  </div>
  <script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js"></script>

-->
    <!--</ul>-->
  </div>
  <p>
  
    <p>首先看一下nodejs的特点：<br>1 js运行环境， 依赖于chrome V8引擎进行代码解释<br>2 事件驱动<br>3 非阻塞I/O<br>4 轻量，可伸缩<br>5 单进程单线程</p>
<p>那么nodejs怎么实现高并发和非阻塞的， 我们看一下系统瓶颈的问题：<br>1 并发连接：<br>1.1 系统线程模型<br>     服务端只有一个线程， 并发请求（用户）到达的只能处理一个，其余的要先等待，这样就是阻塞，正在享受服务的请求阻塞后面的请求。<br>1.2 多线程、线程池模型<br>     多线程： 多个业务员， 高并发的时候还是需要排队。 调节服务端线程的数目来提高对并发请求的接收和相应。由于系统内存资源的受限， 多线程是有限的</p>
<p>1.3 nodejs实现的高并发的 异步、事件驱动模型<br> 每个用户请求都会得到处理， 服务端给请求注册一个激发事件（I/O）， 并给一个回调函数， 然后再事件处理（I/O）处理完成后继续执行下一步回调函数。<br>这样子整个过程是没有阻塞新的用户的链接。<br>但是nodejs是单线程，这样子事件队列越长， 得到相应的时间越长， 并发量会力不从心。</p>
<p>解决：<br>更改连接到服务器的方式，每个连接发射（emit）一个在NodeJS引擎进程中运行的事件（Event），放进事件队列当中，<br>　　而不是为每个连接生成一个新的OS线程（并为其分配一些配套内存）</p>
<p>2  I/O阻塞</p>
<p>每个线程大概会占用 2M 的系统内存<br>2.1 针对串行获取数据，我们就是数据的相加，</p>
<p>2.2 nodejs<br>所有请求以及同时传入的回调函数均发送至同一线程，该线程通常叫做 Event loop 线程，该线程负责在 I/O 执行完毕后，将结果返回给回调函数。这里要注意的是 I/O 操作本身并不在该线程内执行，所以不会阻塞后续请求</p>
<p><img src="./img/nodejs/paixu.jpg" alt="image"><br><img src="./img/nodejs/code.jpg" alt="image"><br><img src="./img/nodejs/nodejs.jpg" alt="image"><br><img src="./img/nodejs/org.jpg" alt="image"></p>
<p>三. NodeJS的优缺点</p>
<p>　　优点：</p>
<p>　　1. 高并发（最重要的优点）</p>
<p>　　2. 适合I/O密集型应用</p>
<p>　   缺点：</p>
<p>　　1. 不适合CPU密集型应用；CPU密集型应用给Node带来的挑战主要是：由于JavaScript单线程的原因，如果有长时间运行的计算（比如大循环），将会导致CPU时间片不能释放，使得后续I/O无法发起；</p>
<p>　　　　解决方案：分解大型运算任务为多个小任务，使得运算能够适时释放，不阻塞I/O调用的发起；</p>
<p>　　2. 只支持单核CPU，不能充分利用CPU</p>
<p>　　3. 可靠性低，一旦代码某个环节崩溃，整个系统都崩溃</p>
<p>　　　　原因：单进程，单线程</p>
<p>　　　　解决方案：（1）Nnigx反向代理，负载均衡，开多个进程，绑定多个端口；</p>
<p>　　　　　　　　　（2）开多个进程监听同一个端口，使用cluster模块；</p>
<p>　　4. 开源组件库质量参差不齐，更新快，向下不兼容</p>
<p>　　5. Debug不方便，错误没有stack trace</p>

  
  </p>
  <footer class="article-footer">
    <a data-url="http://yoursite.com/2015/07/15/nodejs/" data-id="cic4c3rvp0000o4a5s155mjmn" class="article-share-link">Share</a>
    
    
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/nodejs/">nodejs</a></li></ul>


  </footer>
  
</article>


  
    <!-- Post -->
<article id="post-July" class="box post post-excerpt">
  <header>
    
  
    <h2><a href="/2015/07/14/July/">All you had to do was stay</a></h2>
  


  </header>
  <div class="info">
    <span class="date"><span class="month">Jul</span> <span class="day">14</span><span class="year">, 2015</span></span>
    <!--<ul class="stats">-->
      <!--
  <div class="addthis addthis_toolbox addthis_default_style">
    <a class="addthis_counter addthis_pill_style"></a>
  </div>
  <script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js"></script>

-->
    <!--</ul>-->
  </div>
  <p>
  
    <p><strong>All you had to do was stay</strong></p>
<p>霉霉发布在专辑《1989》中，还是一贯的taylor风格。 希望大家不要放弃， 也许峰回路转， 无论是自己还是别人。<br><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">People like you always want back the love they gave away&#10;And people like me wanna believe you when you say you&#39;ve changed&#10;The more I think about it now the less I know&#10;All I know is that you drove us off the road&#10;Stay, hey, all you had to do was stay&#10;Had me in the palm of your hand&#10;Then, why you had to go and lock me out when I let you in&#10;Stay, hey, now you say you want it back&#10;Now that it&#39;s just too late&#10;Well,could&#39;ve been easy all you had to do was stay&#10;All you had to do was stay&#10;All you had to do was stay&#10;All you had to do was stay&#10;All you had to do was stay&#10;Here you are now, calling me up&#10;But I don&#39;t know what to say&#10;I&#39;ve been picking up the pieces of the mess you made&#10;People like you always want back the love they pushed aside&#10;But people like me are gone forever&#10;When you say goodbye&#10;Stay, hey, all you had to do was stay&#10;Had me in the palm of your hand&#10;Then, why you had to go and lock me out when I let you in&#10;Stay, hey, now you say you want it back&#10;Now that it&#39;s just too late&#10;Well,could&#39;ve been easy all you had to do was stay&#10;All you had to do was stay&#10;All you had to do was stay&#10;All you had to do was stay&#10;Let me remind you this was what you wanted&#10;You ended it&#10;You were all I wanted&#10;But not like this&#10;Not like this&#10;Not like this&#10;Oh, all you had to do was stay&#10;Hey, all you had to do was stay&#10;Had me in the palm of your hand&#10;Then, why you had to go and lock me out when I let you in&#10;Stay, hey, now you say you want it back&#10;Now that it&#39;s just too late&#10;Well,could&#39;ve been easy all you had to do was stay&#10;Hey, all you had to do was stay&#10;Had me in the palm of your hand&#10;Then, why you had to go and lock me out when I let you in&#10;Stay, hey, now you say you want it back&#10;Now that it&#39;s just too late&#10;Well,could&#39;ve been easy all you had to do was stay&#10;All you had to do was stay&#10;All you had to do was stay&#10;All you had to do was stay&#10;All you had to do was stay</span><br></pre></td></tr></table></figure></p>

  
  </p>
  <footer class="article-footer">
    <a data-url="http://yoursite.com/2015/07/14/July/" data-id="cic2ykmt10000bca5m33gfdhw" class="article-share-link">Share</a>
    
    
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Taylor/">Taylor</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/歌曲/">歌曲</a></li></ul>


  </footer>
  
</article>


  
    <!-- Post -->
<article id="post-try" class="box post post-excerpt">
  <header>
    
  
    <h2><a href="/2015/07/13/try/">新的开始</a></h2>
  


  </header>
  <div class="info">
    <span class="date"><span class="month">Jul</span> <span class="day">13</span><span class="year">, 2015</span></span>
    <!--<ul class="stats">-->
      <!--
  <div class="addthis addthis_toolbox addthis_default_style">
    <a class="addthis_counter addthis_pill_style"></a>
  </div>
  <script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js"></script>

-->
    <!--</ul>-->
  </div>
  <p>
  
    <p>这是<strong>新的开始</strong>，我用hexo创建了第一篇文章。</p>
<p>通过下面的命令，就可以创建新文章<br><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">D:\workspace\javascript\nodejs-hexo&#62;hexo new &#26032;&#30340;&#24320;&#22987;&#10;[info] File created at D:\workspace\javascript\nodejs-hexo\source\_posts\&#26032;&#30340;&#24320;&#22987;.md</span><br></pre></td></tr></table></figure></p>

  
  </p>
  <footer class="article-footer">
    <a data-url="http://yoursite.com/2015/07/13/try/" data-id="cic2ykmub0007bca5wbyrk75t" class="article-share-link">Share</a>
    
    
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/开始/">开始</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/我/">我</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/日记/">日记</a></li></ul>


  </footer>
  
</article>


  
    <!-- Post -->
<article id="post-hello-world" class="box post post-excerpt">
  <header>
    
  
    <h2><a href="/2015/07/12/hello-world/">Hello World</a></h2>
  


  </header>
  <div class="info">
    <span class="date"><span class="month">Jul</span> <span class="day">12</span><span class="year">, 2015</span></span>
    <!--<ul class="stats">-->
      <!--
  <div class="addthis addthis_toolbox addthis_default_style">
    <a class="addthis_counter addthis_pill_style"></a>
  </div>
  <script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js"></script>

-->
    <!--</ul>-->
  </div>
  <p>
  
    <p>Welcome to <a href="http://hexo.io/" target="_blank" rel="external">Hexo</a>! This is your very first post. Check <a href="http://hexo.io/docs/" target="_blank" rel="external">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="http://hexo.io/docs/troubleshooting.html" target="_blank" rel="external">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues" target="_blank" rel="external">GitHub</a>.</p>
<h2 id="Quick_Start">Quick Start</h2><h3 id="Create_a_new_post">Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">"My New Post"</span></span><br></pre></td></tr></table></figure>
<p>More info: <a href="http://hexo.io/docs/writing.html" target="_blank" rel="external">Writing</a></p>
<h3 id="Run_server">Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure>
<p>More info: <a href="http://hexo.io/docs/server.html" target="_blank" rel="external">Server</a></p>
<h3 id="Generate_static_files">Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure>
<p>More info: <a href="http://hexo.io/docs/generating.html" target="_blank" rel="external">Generating</a></p>
<h3 id="Deploy_to_remote_sites">Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure>
<p>More info: <a href="http://hexo.io/docs/deployment.html" target="_blank" rel="external">Deployment</a></p>

  
  </p>
  <footer class="article-footer">
    <a data-url="http://yoursite.com/2015/07/12/hello-world/" data-id="cic2ykmui000fbca5t5du1v9i" class="article-share-link">Share</a>
    
    

  </footer>
  
</article>


  
  



      </div>
    </div>
    <div id="sidebar">
  <!-- Logo -->
  <div id="logo">
    <h1>We are JQ</h1>
    <h2></h2>
  </div>
  
  <!-- Nav -->
  <nav id="nav">
    <ul>
      
      <li><a href="/">Home</a></li>
      
      <li><a href="/archives">Archives</a></li>
      
    </ul>
  </nav>


  <!-- Hexo Widgets -->
  
    <!-- Search -->
<section class="box search">
  <form action="//google.com/search" method="get" accept-charset="utf-8">
    <input type="search" class="text" name="q" results="0" placeholder="search">
    <input type="hidden" name="q" value="site:yoursite.com">
  </form>
</section>

  
    
  <section class="box recent-posts">
    <header>
      <h2>Recent Posts</h2>
    </header>
    <ul>
      
        <li>
          <a href="/2015/07/15/nodejs/">
            为什么nodejs支持高并发、非阻塞
          </a>
        </li>
        
        <li>
          <a href="/2015/07/14/July/">
            All you had to do was stay
          </a>
        </li>
        
        <li>
          <a href="/2015/07/13/try/">
            新的开始
          </a>
        </li>
        
        <li>
          <a href="/2015/07/12/hello-world/">
            Hello World
          </a>
        </li>
        
    </ul>
  </section>
  

  

  <!-- Copyright -->
  <div id="copyright">
  
  &copy; 2015 Zx Qian and HH Jiang
  
  Powered by: <a href="https://github.com/tommy351/hexo">Hexo</a><br />
  Designed by: <a href="http://html5up.net/">HTML5 UP</a>
  <p>
    
    
    

   </p>
</div>



</div>

    <script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>




<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
  $('.fancybox').fancybox();
})(jQuery);
</script>


  </div>
</body>
</html>
